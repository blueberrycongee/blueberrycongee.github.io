<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>字符串匹配 - BM 算法可视化</title>
    <link rel="stylesheet" href="assets/css/bm.css" />
    <link rel="stylesheet" href="assets/css/theme.css" />
</head>
<body>
  <div class="app-container bm-app">
    <!-- 左侧边栏 -->
    <aside class="sidebar left-sidebar">
      <h2>BM 字符串匹配</h2>
      <div class="controls">
        <h3>输入</h3>
        <div class="input-group">
          <input id="bm-text" class="input-field" type="text" placeholder="文本串 T，例如：abacaabcaba" />
        </div>
        <div class="input-group">
          <input id="bm-pattern" class="input-field" type="text" placeholder="模式串 P，例如：abcaba" />
        </div>

        <div class="controls-row">
          <button id="bm-build-btn" class="action-btn primary-btn" style="flex:1">计算 BC / GS 表</button>
        </div>
        <div class="controls-row" style="margin-top:8px">
          <button id="bm-run-btn" class="action-btn accent-btn" style="flex:1">运行 BM 匹配</button>
        </div>

        <div class="controls-row" style="margin-top:8px">
          <button id="bm-run-bc-btn" class="action-btn" style="flex:1; background:#ffd200; color:#333">仅用坏字符</button>
          <button id="bm-run-gs-btn" class="action-btn" style="flex:1; background:#2ecc71">仅用好后缀</button>
        </div>

        <div class="controls-row" style="margin-top:8px">
          <button id="step-prev-btn" class="control-btn">回退</button>
          <button id="step-next-btn" class="control-btn">前进</button>
        </div>

        <div class="controls-row" style="margin-top:8px">
          <button id="bm-clear-btn" class="control-btn" style="flex:1">清空</button>
        </div>
      </div>

      <div class="info-panel">
        <h3>说明</h3>
        <ul class="info-list">
          <li>BC（坏字符）表：字符在 P 中最后出现的位置。</li>
          <li>GS（好后缀）表：失配时依据已匹配后缀的跳转距离。</li>
          <li>匹配从右向左比较；每步移动为 max(BC, GS)。</li>
        </ul>
      </div>
    </aside>

    <!-- 主画布区域 -->
    <main class="canvas-container">
      <div class="canvas-header">
        <div class="header-top">
          <a href="index.html" class="back-link">← 返回导航页</a>
          <h1>BM 字符串匹配</h1>
        </div>
        <div class="hint-box">
          <p>提示：先计算 BC/GS 表，再运行 BM 并使用回退/前进查看步骤。</p>
        </div>
      </div>
      <svg id="bm-canvas" class="bm-canvas"></svg>
      <div id="bm-grid" class="bm-grid">
        <div class="bm-row" id="text-row" data-label="T:"></div>
        <div class="bm-row" id="pattern-row" data-label="P:"></div>
      </div>
    </main>

    <!-- 右侧属性与表格面板 -->
    <aside class="sidebar right-sidebar">
      <h2>表格与状态</h2>
      <div class="property-panel">
        <div class="property-item"><span class="property-label">T 长度：</span><span id="bm-text-len" class="property-value">0</span></div>
        <div class="property-item"><span class="property-label">P 长度：</span><span id="bm-pattern-len" class="property-value">0</span></div>
        <div class="property-item"><span class="property-label">当前 i（滑窗起点）：</span><span id="bm-i" class="property-value">—</span></div>
        <div class="property-item"><span class="property-label">当前 j（比较索引）：</span><span id="bm-j" class="property-value">—</span></div>
        <div class="property-item"><span class="property-label">移动距离：</span><span id="bm-shift" class="property-value">—</span></div>
      </div>

      <div class="tables-panel">
        <h3>BC（坏字符）表</h3>
        <div id="bc-container" class="table-container">
          <div class="bm-row bm-bc-keys" id="bc-keys-row" data-label="字符"></div>
          <div class="bm-row bm-bc-values" id="bc-values-row" data-label="最后位置"></div>
        </div>
        <h3>GS（好后缀）表</h3>
        <div id="gs-container" class="table-container">
          <div class="bm-row bm-index-row" id="gs-index-row" data-label="位置 j"></div>
          <div class="bm-row bm-value-row" id="gs-value-row" data-label="移动距离"></div>
        </div>
        <h3>SS（后缀连续匹配计数）</h3>
        <div id="ss-container" class="table-container">
          <div class="bm-row bm-index-row" id="ss-index-row" data-label="位置 i"></div>
          <div class="bm-row bm-value-row" id="ss-value-row" data-label="SS[i]"></div>
        </div>
        <h3>GS 辅助数组（suffix / prefix）</h3>
        <div id="sp-container" class="table-container">
          <div class="bm-row bm-sp-index" id="sp-index-row" data-label="长度 k"></div>
          <div class="bm-row bm-suffix-row" id="suffix-row" data-label="suffix[k] 起始"></div>
          <div class="bm-row bm-prefix-row" id="prefix-row" data-label="prefix[k] 是否前缀"></div>
        </div>
      </div>

      <div class="operation-panel">
        <h3>操作步骤</h3>
        <div id="operation-log" class="operation-log"><p class="log-empty">暂无步骤</p></div>
      </div>
    </aside>
  </div>

    <script src="assets/js/animation-controller.js"></script>
    <script src="assets/js/bm.js"></script>
    <script src="assets/js/theme.js"></script>
</body>
</html>