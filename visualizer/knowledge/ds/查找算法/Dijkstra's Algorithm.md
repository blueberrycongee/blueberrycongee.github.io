# 迪杰斯特拉算法 (Dijkstra's Algorithm)

## 问题定义

### 单源最短路径

- **输入**: 连通有向图G，源点s

- **输出**: s到所有其他顶点的最短路径及长度

- **应用**: 交通路线规划、网络路由、通信优化

### 问题分类

1. **单源最短路径**: 给定源点s，计算到其他所有顶点的最短路径

2. **多源最短路径**: 计算所有顶点对之间的最短路径(后续弗洛伊德算法)

## 算法原理

### 核心思想

- **贪心策略**: 每次选择当前距离源点最近的未确定顶点

- **动态更新**: 通过新顶点更新其邻居的最短距离

- **无回溯**: 一旦确定最短距离就不再改变

### 算法步骤

```python

Dijkstra(G, s):

    dist[v] = ∞ for all v

    dist[s] = 0

    S = empty set  # 已确定最短距离的顶点集合

    while S != V:

        v = vertex in V\S with minimum dist[v]

        S = add v to S

        for each neighbor u of v:

            if dist[u] > dist[v] + weight(v,u):

                dist[u] = dist[v] + weight(v,u)

                predecessor[u] = v

```

## 特殊情况处理

### 负权边问题

- **问题**: 存在负权边时算法可能失效

- **原因**: 贪心选择不再保证最优

- **反例**: 源点s到顶点a有两条路径

  - 直接路径: 权重2

  - 间接路径: s→b(权重1) →a(权重-2)，总权重-1

- **算法失效**: 第一次选择a后，不会考虑通过b的更短路径

### 负权环路

- **定义**: 总权重为负的环路

- **问题**: 最短路径无定义(可以无限减小)

- **处理**: 需要检测负权环路

### 相同距离处理

- **策略**: 需要明确的选择规则

- **常见方法**:

  - 按顶点编号顺序

  - 按字典序

  - 随机选择

## 算法实现

### 基于PFS框架

```python

def update_priority(v, u):

    # v是已确定顶点，u是未确定邻居

    if dist[u] > dist[v] + weight(v,u):

        dist[u] = dist[v] + weight(v,u)

        return dist[u]

    return dist[u]

```

### 关键数据结构

- **距离数组**: dist[v] 存储当前已知最短距离

- **前驱数组**: predecessor[v] 存储最短路径上的前驱

- **已确定集合**: S 存储最短距离已确定的顶点

- **优先队列**: 按当前距离排序的顶点集合

## 复杂度分析

### 时间复杂度

- **基本实现**: O(V²)

- **邻接表 + 优先队列**: O((V + E) log V)

- **斐波那契堆**: O(V log V + E)

### 空间复杂度

- **存储**: O(V + E)

- **额外空间**: O(V) 用于距离和前驱数组

## 算法优化

### 优先队列优化

1. **二叉堆**: 标准实现，平衡性能

2. **斐波那契堆**: 理论最优，实际开销大

3. **配对堆**: 实际应用中的良好选择

### 早期终止

- **目标顶点**: 当目标顶点距离确定时即可停止

- **连通性**: 非连通图中只需处理连通分量

### 邻接表优化

- **稀疏图**: 邻接表性能优于邻接矩阵

- **稠密图**: 邻接矩阵可能更高效

## 算法正确性

### 贪心选择性质

- **证明思路**: 数学归纳法

- **关键**: 已选择顶点的距离确实是最短的

- **更新**: 新路径不会更短

### 收敛性

- **有限步**: 每次至少确定一个顶点距离

- **最优性**: 最终距离确实是最短路径长度

> [!WARNING]

> 迪杰斯特拉算法不适用于存在负权边的情况，需要使用贝尔曼-福特算法。

## 实际应用

1. **GPS导航**: 最短路径规划

2. **网络路由**: OSPF协议中的路径计算

3. **社交网络**: 最短关系链发现

4. **游戏AI**: 寻路算法

5. **物流配送**: 配送路线优化

## 算法变种

1. **A*算法**: 启发式搜索，迪杰斯特拉的扩展

2. **双向搜索**: 从源点和目标点同时搜索

3. **层次化搜索**: 大规模网络的分层处理