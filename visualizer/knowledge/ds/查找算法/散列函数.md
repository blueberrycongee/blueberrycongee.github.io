# 核心概念 & 背景

- 词典/映射抽象：很多语言都有字典（哈希表）——**只需能判等**，键未必可比较大小（如“关羽/张飞/赵云”示例）。
    
- 目标：把巨大键空间（如 8 位电话号码，理论上 10^8 个）**压缩映射**到较小地址空间 `[0..m-1]`，实现**期望 O(1)** 存取。
    
- 冲突不可避免：不同键 `k1≠k2` 但可能 `h(k1)=h(k2)`（同义词）。
    
- 装填因子（负载因子）λ＝n/m：**λ↑ → 利用率高但冲突重；λ↓ → 利用率低但冲突少**，典型“以空间换时间”权衡。
    
- “生日悖论”提示：**冲突比直觉更容易发生**（23 人同生日概率≈50.7% → 提示哈希冲突不可完全杜绝）。
    
- 完美散列：特定静态小集合可能存在，但**一般场景可遇不可求**。
    

# 散列函数的设计原则（四条）

1. **确定性**：同一键始终映射同一地址。
    
2. **快速**：计算开销应很小（期望 O(1)）。
    
3. **尽可能“满射”/覆盖**：尽量**充分利用**整个表空间（不是严格数学意义的满射，而是“覆盖广、不浪费”）。
    
4. **均匀性**：映射到各桶的概率尽量接近，**避免聚集**。
    

# 具体方法与要点（附所有课上提到的“点名”事项）

### 1) 除留余数法（Division / Mod）

- 基式：`h(k) = k mod m`。
    
- **m 选素数更稳**：对真实数据（常有模式/周期/相关性）时，**m 为素数**可显著减小模式引发的聚集；  
    对“理想随机”键序列，是否素数影响小，但**现实数据往往非随机**。
    
- **避免 2^k 等合数表长**：易与键的某些模式共振产生聚集。
    
- **考试备注**：在**408**题里，见过“表长 10 但取模 7”的设定；**826 通常 m=表长**（留意题面！）。
    
- **两个缺点（需会说）**：
    
    - **不动点**：`h(0)=0` 永恒成立。
        
    - **相关性**：相邻键常映射相邻桶（如 15→1，16→2，17→3 的感觉），**容易诱发聚集**。
        

### 2) MAD 方法（乘加取模，Multiply-Add-**Divide**）

- 思想：**先线性变换**再取模，打破“不动点”和“相邻保序”。
    
- 形式（常见做法）：`h(k) = ((a·k + b) mod p) mod m`（p≥键域素数；或直接 mod m）。
    
- **选择要点**：通常取 `gcd(a, m)=1`，`b∈[0..m-1]`（保证全域“走得开”）。
    
- 课堂例子：对 15、16… 先做 `2k+1` 再取模，**相邻键映射被打散**（15→3, 16→5…）。
    

### 3) 位/数位抽取法（Digit Selection / Extraction）

- 从十进制/二进制的**特定位**拼出地址（如“取奇数位”）；简单直接，**要警惕输入位分布不均**导致的偏差。
    

### 4) 平方取中法（Mid-Square）

- 取 `k^2` 的**中间几位/比特**作为地址；对首尾位模式**不太敏感**；
    
- 仍可能冲突，仅是分布上较“温和”。
    

### 5) 折叠法（Folding）

- 把键分块后相加/异或等方式**折叠**得到地址；实现简单，但要注意块大小与进位影响。
    

### 6) 字符串哈希：多项式滚动 / 混合位运算

- **多项式哈希**（滚动思想）：`h = (((c0·B + c1)·B + c2)… ) mod M`；  
    可配合**位移/异或**等“扰动”提升扩散性；代码短、工程常用。
    
- **反例必须会举**：**字符简单求和**（如把字符码加总）会造成大量同和冲突（如 "hash" 与 "ahhs"），**不可取**。
    

### 7) 伪随机/通用散列（Universal / Randomized）

- 可用**伪随机参数**做“通用散列族”；但**可移植性差**、不同平台/版本一致性难保证，**慎用**（作业/评测需可复现实验结果时尤其要小心）。
    

# 参数选择与工程口径

- **m 取素数**、与输入规模相当但略大；避免与键的常见模式（进制、步长、周期）发生共振。
    
- **MAD**：`a` 与 `m` 取互素；如可得，优先 `((a·k+b) mod p) mod m` 形式，`p` 取不小于键域的**大素数**更稳。
    
- **电话号示例**：用 `mod 90001` 把 8 位号压到**5 位索引**演示“压缩映射”思想（理解思路即可，实际工程会再配合均匀性评估）。
    

# 冲突与装填因子的交互（从“函数”角度需掌握的判断）

- 无论函数多好，**λ 上去就更易冲突**；降低 λ 可显著改善查找/插入试探长度（后续开放定址/链接法细节见下一节）。
    
- **设计哈希函数 ≠ 解决冲突**：二者是**两条线**，函数要均匀；冲突后还需合适的**排解策略**（线性/平方/双散列/链表）。
    
- **考试会考“给定函数求地址/冲突演化”**：要**能手算**各种方案下的 `h(k)`。
    

# 题场提示（讲稿里的“考点话头”全列出）

- **散列函数的四原则**：会背/会简述。
    
- **Division 法**的两点缺陷（不动点、相邻相关）+ **为何 m 选素数**+ **避免 2^k**。
    
- **MAD 方法**名称与目的（打散相邻与不动点）。
    
- **平方取中、位/数位抽取、折叠法、滚动哈希**：知道定义、优缺点各一句。
    
- **字符求和不可取**：能举“同和”冲例。
    
- **生日悖论结论**（23≈50.7%）：用来解释“冲突很常见”，别被直觉误导。
    
- **m 与取模对象可能不同**这一“坑”：408 曾有“表长10、取模7”的设定；826 基本 m=表长——**审题！**
    
- **完美散列**仅在少量静态集合可做；一般不现实。
    
- **“越随机越好”**是总目标，但**随机数法的可移植性问题**要知道。
    

# 术语/转写校正

- “**三列/三列表**”均为**“散列/散列表（哈希表）”**。
    
- “**开场列**”应为**“开放寻址（open addressing）”**（本讲后续章节）。
    
- “**统排序**”应为**“桶排序”**；“基数排序、桶排序、跳表”确实在本章体系内常被一并复习。
    
- “**MA 地方**”是 **MAD（Multiply-Add-Divide）方法**的口语化写法；  
    文中示例等价于“先做线性变换再取模”以打散相邻。
    
- “**满射**”在此非严格数理定义，指“尽可能覆盖空间、不浪费桶位”。
    

---

需要的话，我可以把这些点各自配上**最小例题**（含手算步骤）做一页“口袋卡片”。