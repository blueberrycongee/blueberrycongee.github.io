## 1、插入排序 (Insertion Sort)

### 1. 算法原理与图示

- ​**适用性：​**​ 插入排序可以基于向量 (Array) 实现，也可以基于列表 (List) 实现。
    
- ​**核心思想：​**​ 始终将序列视作两个部分：
    
    1. ​**有序前缀区 (Sorted Prefix)​**​
        
    2. ​**待排后缀区 (Unsorted Suffix)​**​
        
    
- ​**算法流程：​**​ 反复从 "待排后缀区" 取出第一个元素，在 "有序前缀区" 中找到合适的位置并**插入**。
    
- ​**示例：​**​ `[5, 2, 7, 4, 6, 3, 1]`
    
    1. `[5]`| `[2, 7, 4, 6, 3, 1]`(5 插入)
        
    2. `[2, 5]`| `[7, 4, 6, 3, 1]`(2 插入到 5 前面)
        
    3. `[2, 5, 7]`| `[4, 6, 3, 1]`(7 插入到 5 后面)
        
    4. `[2, 4, 5, 7]`| `[6, 3, 1]`(4 插入到 2 和 5 之间)
        
    5. `[2, 4, 5, 6, 7]`| `[3, 1]`(6 插入到 5 和 7 之间)
        
    6. `[2, 3, 4, 5, 6, 7]`| `[1]`(3 插入到 2 和 4 之间)
        
    7. `[1, 2, 3, 4, 5, 6, 7]`| `[]`(1 插入到 2 前面)
        
    
- ​**查找方向：​**​ 在 "有序前缀区" 查找插入位置时，标准实现是**从右向左**​ (即从后向前) 比较。
    

### 2. 复杂度分析

- ​**最好情况： O(n)​**​
    
    - 当序列**完全有序**时 (如 `[1, 2, 3, 4, 5, 6, 7]`)。
        
    - 每次从后缀区拿到的元素，都比有序区末尾的元素大，只需比较 1 次，无需移动，直接追加到有序区末尾。
        
    
- ​**最坏情况： O(n2)​**​
    
    - 当序列**完全逆序**时 (如 `[7, 6, 5, 4, 3, 2, 1]`)。
        
    - 每次拿到的元素都是当前最小的，需要**从右到左**比较完所有有序区的元素，并插入到最前端。
        
    

> [!WARNING] 讲师批注：不要 "开上帝视角"
> 
> - 有同学可能会 "抬杠"：如果我知道是完全逆序，我**从左向右**比较，是不是就是 O(n)了？
>     
> - ​**反驳：​**​ 算法在执行前**无法预知**输入数据的分布。
>     
> - 如果你强行改成 "从左向右" 比较，那么对于**完全有序**​ (即最好情况) 的输入 (如 `[1, 2, 3, 4]`)，反而会**退化**成 O(n2)(如插入 4 时，需要和 1, 2, 3 依次比较)。
>     
> - 不能根据输入来"双重标准"地选择算法实现。
>     


    

---

## 三、课后习题解析 (随堂练习)

​**练习 1：​**​

> 对于插入排序过程中，已排子序列 (设长度为 k) ...
> 
> (A) 其中的元素是整个序列当中最小的 k个元素
> 
> (B) 其中的元素是整个序列当中最大的 k个元素
> 
> (C) 其中的元素是原序列中位于前方的 k个元素

- ​**分析：​**​
    
    - (A) 错误。例：`[3, 2, 1]`，第一步排序后，有序区为 `[2, 3]`，待排区 `[1]`。`[2, 3]`并不是最小的两个元素。
        
    - (B) 错误。例：`[1, 2, 3]`，第一步排序后，有序区为 `[1, 2]`，待排区 `[3]`。`[1, 2]`并不是最大的两个元素。
        
    - (C) 正确。插入排序是 "就地" (in-place) 的，它只是将**原序列**的前 k个元素进行了排序，构成了有序区。
        
    
- ​**答案：C**​
    

​**练习 2：​**​

> 此时已排序的部分有 3 个元素 [2,7,13]，待排序的部分是 [5,3]。经过一轮迭代后，已排序的部分是？

- ​**分析：​**​
    
    - 下一轮迭代是取出待排区的第一个元素 ​**5**。
        
    - 将 5 插入到有序区 `[2, 7, 13]`中。
        
    - 从右向左比较：5 < 13，5 < 7，5 > 2。
        
    - 5 被插入到 2 和 7 之间。
        
    
- ​**答案：(C) [2,5,7,13]​**