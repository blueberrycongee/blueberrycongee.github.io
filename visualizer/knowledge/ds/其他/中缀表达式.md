### 1. 什么是中缀表达式？

中缀表达式是我们日常生活中最熟悉、最常用的一种数学表达式书写方式。它的核心特点是：​**运算符位于两个操作数的中间**。

​**例如：​**​

- `A + B`
    
- `5 * 3 - 2`
    
- `( 10 + 2 ) * 3 / 4`
    

这些都是中缀表达式。我们人类非常习惯这种写法，因为它直观、易于理解。

---

### 2. 中缀表达式的优缺点

​**优点：​**​

- ​**符合人类直觉**​：非常易于我们阅读和理解。
    

​**缺点（对计算机而言）：​**​

- ​**计算过程复杂**​：计算机无法像人眼一样直接识别优先级。要计算一个中缀表达式，计算机需要：
    
    1. ​**考虑优先级**​：不断扫描整个表达式来判断先算哪一部分。
        
    2. ​**处理括号**​：需要匹配左右括号，并处理嵌套的括号。
        
    3. ​**多次扫描**​：这个过程可能需要从左到右、从右到左多次扫描，效率很低。
        
    

正是因为这些缺点，在计算机科学中，我们通常会将中缀表达式转换成其他形式，以便于计算机高效地求值。

---

### 3. 中缀表达式的转换与求值

为了让计算机处理，我们主要有两种方法：

#### 方法一：转换为后缀表达式（逆波兰表示法），再求值

这是最常用、最经典的方法。后缀表达式的特点是运算符在操作数的后面，它没有优先级问题，也不需要使用括号，计算顺序完全由运算符的位置决定。

​**转换和求值步骤：​**​

1. ​**转换**​：利用一个**栈**​ 将中缀表达式转换为后缀表达式。
    
    - ​**算法概要**​：
        
        - 初始化一个空栈（用于存放运算符）。
            
        - 从左到右扫描中缀表达式。
            
        - 遇到操作数，直接输出（成为后缀表达式的一部分）。
            
        - 遇到运算符：
            
            - 若栈为空，或栈顶是左括号 `(`，或当前运算符优先级比栈顶运算符高，则将此运算符入栈。
                
            - 否则，将栈顶运算符弹出并输出，再比较新的栈顶运算符，直到满足入栈条件为止。
                
            
        - 遇到左括号 `(`，直接入栈。
            
        - 遇到右括号 `)`，则依次弹出栈顶运算符并输出，直到遇到左括号 `(`为止（这一对括号丢弃）。
            
        - 扫描完毕后，将栈中所有剩余运算符依次弹出并输出。
            
        
    
2. ​**求值**​：对得到的后缀表达式进行求值，同样使用一个栈。
    
    - ​**算法概要**​：
        
        - 初始化一个空栈（用于存放操作数）。
            
        - 从左到右扫描后缀表达式。
            
        - 遇到操作数，将其压入栈。
            
        - 遇到运算符，从栈顶弹出两个操作数（注意顺序：先弹出的是右操作数，后弹出的是左操作数），进行运算，并将结果压回栈中。
            
        - 扫描结束后，栈中唯一的元素就是表达式的最终结果。
            
        
    

​**举例：中缀表达式 `5 + ( ( 1 + 2 ) * 4 ) - 3`**​

1. ​**转换为后缀表达式：​**​
    
    - 扫描 `5`-> 输出 `5`
        
    - 扫描 `+`-> 入栈 `[+]`
        
    - 扫描 `(`-> 入栈 `[+, (]`
        
    - 扫描 `(`-> 入栈 `[+, (, (]`
        
    - 扫描 `1`-> 输出 `5 1`
        
    - 扫描 `+`-> 入栈 `[+, (, (, +]`
        
    - 扫描 `2`-> 输出 `5 1 2`
        
    - 扫描 `)`-> 弹出直到 `(`，输出 `+`，栈变为 `[+, (]`，输出为 `5 1 2 +`
        
    - 扫描 `*`-> 入栈 `[+, (, *]`
        
    - 扫描 `4`-> 输出 `5 1 2 + 4`
        
    - 扫描 `)`-> 弹出直到 `(`，输出 `*`，栈变为 `[+]`，输出为 `5 1 2 + 4 *`
        
    - 扫描 `-`-> `-`优先级等于 `+`，弹出 `+`并输出，将 `-`入栈 `[-]`，输出为 `5 1 2 + 4 * +`
        
    - 扫描 `3`-> 输出 `5 1 2 + 4 * + 3`
        
    - 扫描结束，弹出栈中 `-`，输出为 `5 1 2 + 4 * + 3 -`
        
    - ​**最终的后缀表达式是：`5 1 2 + 4 * + 3 -`**​
        
    
2. ​**对后缀表达式求值：​**​
    
    - 扫描 `5`-> 栈 `[5]`
        
    - 扫描 `1`-> 栈 `[5, 1]`
        
    - 扫描 `2`-> 栈 `[5, 1, 2]`
        
    - 扫描 `+`-> 弹出 `2`和 `1`，计算 `1 + 2 = 3`，入栈 `[5, 3]`
        
    - 扫描 `4`-> 栈 `[5, 3, 4]`
        
    - 扫描 `*`-> 弹出 `4`和 `3`，计算 `3 * 4 = 12`，入栈 `[5, 12]`
        
    - 扫描 `+`-> 弹出 `12`和 `5`，计算 `5 + 12 = 17`，入栈 `[17]`
        
    - 扫描 `3`-> 栈 `[17, 3]`
        
    - 扫描 `-`-> 弹出 `3`和 `17`，计算 `17 - 3 = 14`
        
    - ​**最终结果：14**​
        
    

#### 方法二：使用双栈直接求值（调度场算法）

也可以不显式地转换成后缀表达式，而是使用两个栈（一个操作数栈，一个运算符栈）直接对中缀表达式进行求值。其核心思想与转换过程非常相似，只是在遇到运算符时，如果条件满足，会直接从操作数栈弹出操作数进行运算，并将结果压回操作数栈。

---

### 总结

|特性|描述|
|---|---|
|​**定义**​|运算符位于两个操作数之间的表达式。|
|​**人类可读性**​|​**好**，非常直观。|
|​**计算机处理**​|​**差**，需要处理优先级和括号，计算复杂。|
|​**处理方法**​|通常需要转换为**后缀表达式**或使用**双栈算法**来求值。|
|​**关键数据结构**​|​**栈**，用于管理运算符的优先级和顺序。|
